<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Geocode PWA</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css" />
  <script>
    async function sendLink() {
      const input = document.getElementById("sheet-link");
      const btn = document.getElementById("link-btn");
      btn.disabled = true;
      btn.textContent = "‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞...";
      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbzoSPntHBFxCeQUJy4MRTcfAsAiQq2faZ9bn-Fq7Y0MqBtVMu9PbSyD6QCwEqF_wt9G/exec", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ link: input.value })
        });
        const text = await response.text();
        btn.textContent = text.includes("‚úÖ") ? "‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ" : "‚ùå –û—à–∏–±–∫–∞";
      } catch (e) {
        btn.textContent = "‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–µ—Ç–∏";
      }
    }

    async function runGeocoding() {
      const runBtn = document.getElementById("run-btn");
      runBtn.disabled = true;
      runBtn.textContent = "‚è≥ –ó–∞–ø—É—Å–∫...";
      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbzoSPntHBFxCeQUJy4MRTcfAsAiQq2faZ9bn-Fq7Y0MqBtVMu9PbSyD6QCwEqF_wt9G/exec");
        runBtn.textContent = response.ok ? "‚úÖ –ì–æ—Ç–æ–≤–æ!" : "‚ùå –û—à–∏–±–∫–∞";
      } catch (e) {
        runBtn.textContent = "‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–µ—Ç–∏";
      }
    }
  </script>
</head>
<body>
  <div class="container">
    <input type="text" id="sheet-link" placeholder="–í—Å—Ç–∞–≤—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–∞–±–ª–∏—Ü—É..." />
    <button id="link-btn" onclick="sendLink()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Å—ã–ª–∫—É</button>
    <button id="run-btn" onclick="runGeocoding()">‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
  </div>
</body>
</html>
